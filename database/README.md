# База данных T2 Mobile (SQLite)

Эта директория содержит все необходимые файлы для работы с базой данных SQLite проекта T2 Mobile.

## Файлы базы данных

- `t2mobile.db` - основной файл базы данных SQLite (находится в корневой директории проекта)

## Скрипты

- `init_db.sql` - SQL скрипт для инициализации базы данных
- `create_db.js` - JavaScript скрипт для создания и наполнения базы данных
- `check_db.js` - JavaScript скрипт для проверки содержимого базы данных

## Структура базы данных

База данных содержит следующие таблицы:

### Таблица `users`

Содержит данные пользователей системы (администраторы и клиенты).

| Поле        | Тип         | Описание                              |
|-------------|-------------|---------------------------------------|
| id          | INTEGER     | Первичный ключ                        |
| email       | TEXT        | Email пользователя (должен быть уникальным) |
| password    | TEXT        | Пароль пользователя                    |
| name        | TEXT        | Имя пользователя                      |
| type        | TEXT        | Тип пользователя ('admin' или 'client') |
| phone       | TEXT        | Номер телефона                        |
| avatar      | TEXT        | Ссылка на аватар пользователя         |
| created_at  | TIMESTAMP   | Дата и время создания записи          |

### Таблица `customers`

Содержит данные о клиентах компании.

| Поле        | Тип         | Описание                              |
|-------------|-------------|---------------------------------------|
| id          | INTEGER     | Первичный ключ                        |
| name        | TEXT        | Наименование клиента                  |
| email       | TEXT        | Email клиента                         |
| phone       | TEXT        | Номер телефона                        |
| address     | TEXT        | Адрес                                 |
| notes       | TEXT        | Примечания                            |
| created_at  | TIMESTAMP   | Дата и время создания записи          |

### Таблица `packages`

Содержит доступные пакеты услуг.

| Поле        | Тип         | Описание                              |
|-------------|-------------|---------------------------------------|
| id          | INTEGER     | Первичный ключ                        |
| name        | TEXT        | Название пакета                       |
| description | TEXT        | Описание пакета                       |
| price       | REAL        | Стоимость пакета                      |
| created_at  | TIMESTAMP   | Дата и время создания записи          |

### Таблица `sales`

Содержит информацию о продажах.

| Поле        | Тип         | Описание                              |
|-------------|-------------|---------------------------------------|
| id          | INTEGER     | Первичный ключ                        |
| customer_id | INTEGER     | ID клиента (внешний ключ)             |
| package_id  | INTEGER     | ID пакета услуг (внешний ключ)        |
| amount      | REAL        | Сумма продажи                         |
| sale_date   | TEXT        | Дата продажи                          |
| created_at  | TIMESTAMP   | Дата и время создания записи          |

## Как использовать базу данных

### Создание новой базы данных

Для создания новой базы данных выполните следующую команду:

```bash
node database/create_db.js
```

### Проверка содержимого базы данных

Для проверки содержимого базы данных выполните:

```bash
node database/check_db.js
```

### Подключение к базе данных из приложения

```javascript
const sqlite3 = require('sqlite3').verbose();
const path = require('path');

// Путь к файлу базы данных
const dbPath = path.join(__dirname, 'path/to/t2mobile.db');

// Подключение к базе данных
const db = new sqlite3.Database(dbPath, (err) => {
  if (err) {
    console.error('Ошибка подключения к базе данных:', err.message);
    return;
  }
  console.log('Подключение к базе данных установлено');
});

// Выполнение запроса
db.all('SELECT * FROM users', [], (err, rows) => {
  if (err) {
    throw err;
  }
  
  // Обработка результатов
  rows.forEach((row) => {
    console.log(row);
  });
});

// Закрытие соединения
db.close((err) => {
  if (err) {
    console.error('Ошибка при закрытии соединения:', err.message);
    return;
  }
  console.log('Соединение с базой данных закрыто');
});
``` 